import java.util.Random;

public class Tablero {
    private Ficha[][] fichas;
    private int tamaÃ±o;
    private String[] simbolos;

    public Tablero(int tamaÃ±o) {
        this.tamaÃ±o = tamaÃ±o;
        this.fichas = new Ficha[tamaÃ±o][tamaÃ±o];
        this.simbolos = new String[]{"ğŸ®", "ğŸ¯", "ğŸª", "ğŸ¨", "ğŸ­", "ğŸ²", "ğŸ¸", "ğŸº", 
                                    "ğŸ", "ğŸŠ", "ğŸ‹", "ğŸŒ", "ğŸ‡", "ğŸ“", "âš½", "ğŸ€", "ğŸ¾", "ğŸ†"};
        inicializarTablero();
    }
    private void inicializarTablero() {
        int totalCasillas = tamaÃ±o * tamaÃ±o;
        int numPares = totalCasillas / 2;

        String[] fichasTemp = new String[totalCasillas];

        for (int i = 0; i < numPares; i++) {
            fichasTemp[i * 2] = simbolos[i];
            fichasTemp[i * 2 + 1] = simbolos[i];
        }

        Random rand = new Random();
        for (int i = 0; i < totalCasillas; i++) {
            int pos = rand.nextInt(totalCasillas);
            String temp = fichasTemp[i];
            fichasTemp[i] = fichasTemp[pos];
            fichasTemp[pos] = temp;
        }

        int contador = 0;
        for (int i = 0; i < tamaÃ±o; i++) {
            for (int j = 0; j < tamaÃ±o; j++) {
                fichas[i][j] = new Ficha(fichasTemp[contador]);
                contador++;
            }
        }
    }
    public String mostrarTablero() {
        String resultado = "\n   ";

        for (int j = 0; j < tamaÃ±o; j++) {
            resultado = resultado + " " + j + " ";
        }
        resultado = resultado + "\n";

        for (int i = 0; i < tamaÃ±o; i++) {
            resultado = resultado + i + "  ";
            for (int j = 0; j < tamaÃ±o; j++) {
                if (fichas[i][j].isDescubierta() || fichas[i][j].isEmparejada()) {
                    resultado = resultado + fichas[i][j].getSimbolo() + " ";
                } else {
                    resultado = resultado + "â“ ";
                }
            }
            resultado = resultado + "\n";
        }
        return resultado;
    }

    public boolean seleccionarFicha(int fila, int columna) {
        if (verificarPosicion(fila, columna)) {
            fichas[fila][columna].descubrir();
            return true;
        }
        return false;
    }

    public void ocultarFichas() {
        for (int i = 0; i < tamaÃ±o; i++) {
            for (int j = 0; j < tamaÃ±o; j++) {
                if (!fichas[i][j].isEmparejada()) {
                    fichas[i][j].ocultar();
                }
            }
        }
    }

    public boolean verificarPosicion(int fila, int columna) {
        if (fila >= 0 && fila < tamaÃ±o && columna >= 0 && columna < tamaÃ±o) {
            return !fichas[fila][columna].isEmparejada() && !fichas[fila][columna].isDescubierta();
        }
        return false;
    }

    public boolean todasEmparejadas() {
        for (int i = 0; i < tamaÃ±o; i++) {
            for (int j = 0; j < tamaÃ±o; j++) {
                if (!fichas[i][j].isEmparejada()) {
                    return false;
                }
            }
        }
        return true;
    }

    public Ficha getFicha(int fila, int columna) {
        return fichas[fila][columna];
    }
    public void emparejarFichas(int fila1, int col1, int fila2, int col2) {
        fichas[fila1][col1].emparejar();
        fichas[fila2][col2].emparejar();
    }
}
